Πρόγραμμα ελέγχου δεδομένων 
===========================

# Αρχικές ρυθμίσεις 

Για να λειτουργήσει σωστά το πρόγραμμα, αντιγράψτε το αρχείο `settings.php.dist` σε ένα 
νέο αρχείο `settings.php` και τροποποιήστε αναλόγως, για παράδειγμα εισάγοντας το όνομα 
χρήστη που σας έχει αποδοθεί. 

# Είσοδοι και έξοδοι 

Η κύρια είσοδος του προγράμματος είναι ένα αρχείο μορφής csv, χωρισμένο με `;`, το οποίο
περιλαμβάνει τους κωδικούς αριθμούς προς αναζήτηση. 

Η έξοδος του προγράμματος είναι:

- ένα csv αρχείο το οποίο περιλαμβάνει τα δεδομένα που αντλήθηκαν από την υπηρεσία 
- στατιστικά στοιχεία και δεδομένα καταγραφής, στο stdout

# Εκτέλεση του προγράμματος 

Για την επίδειξη των διαθέσιμων λειτουργιών έχει αναπτυχθεί πρόγραμμα [index.php](index.php) 
που εκτελείται από τη γραμμή εντολών.
Το πρόγραμμα δέχεται τις παρακάτω παραμέτρους: 

```
Χρήση: index.php [--input <file>] [--output <file>]
    [--amka <amka column #>] [--line <start line #>] [--maxcheck <max lines #>]
          input <file>: έλεγχος στοιχείων από το αρχείο <file> (ένα μόνο αρχείο)
         output <file>: τελικά αποτελέσματα (csv) στο <file> (ένα μόνο αρχείο)
       amka <column #>: αριθμός στήλης που περιέχει το ΑΜΚΑ (πρώτη == 0)
   line <start line #>: αριθμός πρώτης γραμμής με δεδομένα (πρώτη == 1)
maxcheck <max lines #>: αριθμός εγγραφών για έλεγχο (κενό = όλες)
```

Το πρόγραμμα χρησιμοποιεί τη δοκιμαστική βιβλιοθήκη επίδειξης που περιλαμβάνεται στην 
[SLIM based web εφαρμογή Gr\Gov\Minedu\Osteam\Slim\Client](../slim-app/src/osteam/Client.php)

## Gr\Gov\Minedu\Osteam\App\Extract 

Η κλάση [Gr\Gov\Minedu\Osteam\App\Extract](src/Extract.php) παρέχει μεθόδους κατανάλωσης της
υπηρεσίας ακαδημαϊκής ταυτότητας μέσω του WSO2 api manager. Οι βασικές λειτουργίες είναι: 

* getAcademicID($amka, $auth_header_student) 
* getStudentInformation($academic_id, $auth_header_student)

## Gr\Gov\Minedu\Osteam\Slim\Client 

Η κλάση [Gr\Gov\Minedu\Osteam\Slim\Client](src/Client.php) παρέχει λειτουργίες για την
κλήση των απομακρυσμένων υπηρεσιών, όπως: 

* _put($uri, $payload, $headers = [])_
* _post($uri, $payload, $headers = [])_
* _get($uri, $params = [], $headers = [])_

## Παραδείγματα κλήσης

### Χρήση κωδικών από αρχείο, χωρίς άλλες παραμέτρους  

```sh
$ php index.php --input test.csv
Ζητήσατε να γίνει έλεγχος από τo αρχείo: test.csv
         Έναρξη στοιχείων από τη γραμμή: 1
                    Αριθμός στήλης ΑΜΚΑ: 0
            Αποθήκευση στο αρχείο (csv): out.csv
Έλεγχος όλων των εγγραφών
Να συνεχίσουμε; (y/N/ν/Ο) y

=========================================
...................
...................
Ολοκληρώθηκε.
```

### Χρήση κωδικών από αρχείο, με παραμέτρους

* έλεγχος του 3ου μόνο κωδικού
* αποτελέσματα στο αρχείο one.csv 

```sh
$ php index.php --input test.csv --output one.csv --line 3 --maxcheck 1
Ζητήσατε να γίνει έλεγχος από τo αρχείo: test.csv
         Έναρξη στοιχείων από τη γραμμή: 3
                    Αριθμός στήλης ΑΜΚΑ: 0
            Αποθήκευση στο αρχείο (csv): one.csv
Έλεγχος 1 εγγραφών
Να συνεχίσουμε; (y/N/ν/Ο) y
POP 2 lines...

=========================================
...................
...................
Ολοκληρώθηκε.
```
